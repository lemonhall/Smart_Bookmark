import{O as T,d as I,i as v,D as a,o as R,l as N,b as h,c as x,e as t,f as b,v as g,p as k,n as E,t as w,g as P,q as V,s as _,_ as B,m as L}from"./chunks/_plugin-vue_export-helper.js";async function q(y){const p=y.baseUrl.trim(),c=y.apiKey,l=y.model.trim();if(!p)return{ok:!1,error:"Base URL is required"};if(!l)return{ok:!1,error:"Model is required"};if(!c)return{ok:!1,error:"API Key is required"};try{const u=((await new T({baseUrl:p}).complete({model:l,apiKey:c,store:!1,instructions:"Reply with exactly: Hello world.",input:[{role:"user",content:[{type:"input_text",text:"Hello world"}]}]})).assistantText??"").trim();return u?{ok:!0,assistantText:u}:{ok:!1,error:"Empty response"}}catch(r){return{ok:!1,error:(r instanceof Error?r.message:String(r))||"Unknown error"}}}const M={class:"page"},$={class:"card"},D={class:"row"},F={class:"row"},H={class:"card"},G={class:"row"},z={class:"row"},W=["disabled"],j={class:"row"},J={class:"row"},Q={class:"row"},X={class:"footer"},Y={class:"actions"},Z=["disabled"],ee=["disabled"],te=["disabled"],se=I({__name:"OptionsApp",setup(y){const p=v(a.topN),c=v(a.closeOnSave),l=v(a.ai.enabled),r=v(a.ai.alwaysSuggest),i=v(a.ai.baseUrl),u=v(a.ai.model),m=v(a.ai.apiKey),d=v(!1),f=V({kind:"idle",message:""});function n(s,e){f.kind=s,f.message=e}function O(s){try{const e=new URL(s);return e.protocol!=="https:"&&e.protocol!=="http:"?null:`${e.origin}/*`}catch{return null}}async function S(){const s=O(i.value);if(!s)return n("error","Invalid Base URL (must be http(s) URL)"),!1;try{if(await chrome.permissions.contains({origins:[s]}))return!0}catch{}try{return await chrome.permissions.request({origins:[s]})?!0:(n("error",`Permission denied for ${s}`),!1)}catch{return n("error",`Unable to request permission for ${s}`),!1}}async function A(){try{await chrome.tabs.create({url:"chrome://extensions/shortcuts"})}catch{n("error","Unable to open chrome://extensions/shortcuts")}}async function U(){d.value=!0,n("idle","");try{l.value&&(await S()||(l.value=!1)),await _({topN:p.value,closeOnSave:c.value,ai:{enabled:l.value,alwaysSuggest:r.value,baseUrl:i.value,model:u.value,apiKey:m.value}}),n("ok",l.value?"Saved (AI enabled)":"Saved")}catch{n("error","Save failed")}finally{d.value=!1}}async function C(){d.value=!0,n("idle","");try{if(!await S())return;const e=await q({baseUrl:i.value,apiKey:m.value,model:u.value});if(!e.ok){n("error",`Test failed: ${e.error}`);return}n("ok",`OK: ${e.assistantText}`)}catch{n("error","Test failed")}finally{d.value=!1}}async function K(){p.value=a.topN,c.value=a.closeOnSave,l.value=a.ai.enabled,r.value=a.ai.alwaysSuggest,i.value=a.ai.baseUrl,u.value=a.ai.model,m.value=a.ai.apiKey,await U()}return R(async()=>{try{const s=await N();p.value=s.topN,c.value=s.closeOnSave,l.value=s.ai.enabled,r.value=s.ai.alwaysSuggest,i.value=s.ai.baseUrl,u.value=s.ai.model,m.value=s.ai.apiKey}catch{n("error","Failed to load settings")}}),(s,e)=>(h(),x("main",M,[e[18]||(e[18]=t("header",{class:"header"},[t("h1",{class:"title"},"Smart Bookmark — Options"),t("p",{class:"subtitle"},"Settings are stored locally in your browser profile.")],-1)),t("section",$,[e[10]||(e[10]=t("h2",{class:"card-title"},"General",-1)),t("div",D,[e[7]||(e[7]=t("label",{class:"label",for:"topN"},"Recommended folders (Top N)",-1)),b(t("input",{id:"topN",class:"input",type:"number",min:"1",max:"10",step:"1","onUpdate:modelValue":e[0]||(e[0]=o=>p.value=o)},null,512),[[g,p.value,void 0,{number:!0}]])]),t("div",F,[e[8]||(e[8]=t("label",{class:"label",for:"closeOnSave"},"Close popup after saving",-1)),b(t("input",{id:"closeOnSave",type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=o=>c.value=o)},null,512),[[k,c.value]])]),t("div",{class:"row"},[t("button",{class:"link",type:"button",onClick:A},"Open Chrome shortcuts"),e[9]||(e[9]=t("span",{class:"hint"},"Configure the extension hotkey in Chrome.",-1))])]),t("section",H,[e[16]||(e[16]=t("h2",{class:"card-title"},"AI Fallback (OpenAI-compatible)",-1)),t("div",G,[e[11]||(e[11]=t("label",{class:"label",for:"aiEnabled"},"Enable AI fallback",-1)),b(t("input",{id:"aiEnabled",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=o=>l.value=o)},null,512),[[k,l.value]])]),t("div",z,[e[12]||(e[12]=t("label",{class:"label",for:"alwaysSuggest"},"Always show AI suggestions",-1)),b(t("input",{id:"alwaysSuggest",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>r.value=o),disabled:!l.value},null,8,W),[[k,r.value]])]),t("div",j,[e[13]||(e[13]=t("label",{class:"label",for:"baseUrl"},"Base URL",-1)),b(t("input",{id:"baseUrl",class:"input",type:"text",placeholder:"https://api.openai.com/v1","onUpdate:modelValue":e[4]||(e[4]=o=>i.value=o)},null,512),[[g,i.value,void 0,{trim:!0}]])]),t("div",J,[e[14]||(e[14]=t("label",{class:"label",for:"model"},"Model",-1)),b(t("input",{id:"model",class:"input",type:"text",placeholder:"gpt-5.2","onUpdate:modelValue":e[5]||(e[5]=o=>u.value=o)},null,512),[[g,u.value,void 0,{trim:!0}]])]),t("div",Q,[e[15]||(e[15]=t("label",{class:"label",for:"apiKey"},"API Key",-1)),b(t("input",{id:"apiKey",class:"input",type:"password",placeholder:"sk-...","onUpdate:modelValue":e[6]||(e[6]=o=>m.value=o),autocomplete:"off"},null,512),[[g,m.value]])]),e[17]||(e[17]=t("p",{class:"hint"}," Only sent when AI is enabled and host-based recommendations are empty. The request includes the current tab URL/title and folder candidates (id/path) — it does not upload existing bookmark URLs. ",-1))]),t("footer",X,[f.kind!=="idle"?(h(),x("div",{key:0,class:E(["status",f.kind])},w(f.message),3)):P("",!0),t("div",Y,[t("button",{class:"button secondary",type:"button",onClick:C,disabled:d.value},w(d.value?"Working…":"Test"),9,Z),t("button",{class:"button secondary",type:"button",onClick:K,disabled:d.value},"Reset",8,ee),t("button",{class:"button",type:"button",onClick:U,disabled:d.value},w(d.value?"Saving…":"Save"),9,te)])])]))}}),ae=B(se,[["__scopeId","data-v-7f5fee25"]]);L(ae).mount("#app");
