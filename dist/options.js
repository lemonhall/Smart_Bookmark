import{O as R,d as T,i as d,D as a,o as N,l as E,b as A,c as L,e as s,f as v,v as w,p as h,n as M,t as S,g as P,j as V,q as _,s as q,_ as B,m as $}from"./chunks/_plugin-vue_export-helper.js";async function D(f){const c=f.baseUrl.trim(),p=f.apiKey,l=f.model.trim();if(!c)return{ok:!1,error:"Base URL is required"};if(!l)return{ok:!1,error:"Model is required"};if(!p)return{ok:!1,error:"API Key is required"};try{const u=((await new R({baseUrl:c}).complete({model:l,apiKey:p,store:!1,instructions:"Reply with exactly: Hello world.",input:[{role:"user",content:[{type:"input_text",text:"Hello world"}]}]})).assistantText??"").trim();return u?{ok:!0,assistantText:u}:{ok:!1,error:"Empty response"}}catch(i){return{ok:!1,error:(i instanceof Error?i.message:String(i))||"Unknown error"}}}const F={class:"page"},H={class:"card"},G={class:"row"},j={class:"row"},z={class:"card"},J={class:"row"},Q={class:"row"},W=["disabled"],X={class:"row"},Y={class:"row"},Z={class:"row"},ee={class:"footer"},se={class:"actions"},te=["disabled"],ae=["disabled"],oe=["disabled"],le=T({__name:"OptionsApp",setup(f){const c=d(a.topN),p=d(a.closeOnSave),l=d(a.ai.enabled),i=d(a.ai.alwaysSuggest),r=d(a.ai.baseUrl),u=d(a.ai.model),b=d(a.ai.apiKey),y=d(!1),g=d(!1),k=V(()=>y.value||g.value),m=_({kind:"idle",message:""});function n(t,e){m.kind=t,m.message=e}function O(t){try{const e=new URL(t);return e.protocol!=="https:"&&e.protocol!=="http:"?null:`${e.origin}/*`}catch{return null}}async function U(){const t=O(r.value);if(!t)return n("error","Invalid Base URL (must be http(s) URL)"),!1;try{if(await chrome.permissions.contains({origins:[t]}))return!0}catch{}try{return await chrome.permissions.request({origins:[t]})?!0:(n("error",`Permission denied for ${t}`),!1)}catch{return n("error",`Unable to request permission for ${t}`),!1}}async function I(){try{await chrome.tabs.create({url:"chrome://extensions/shortcuts"})}catch{n("error","Unable to open chrome://extensions/shortcuts")}}async function x(){y.value=!0,n("idle","");try{l.value&&(await U()||(l.value=!1)),await q({topN:c.value,closeOnSave:p.value,ai:{enabled:l.value,alwaysSuggest:i.value,baseUrl:r.value,model:u.value,apiKey:b.value}}),n("ok",l.value?"Saved (AI enabled)":"Saved")}catch{n("error","Save failed")}finally{y.value=!1}}async function C(){g.value=!0,n("idle","");try{if(!await U())return;const e=await D({baseUrl:r.value,apiKey:b.value,model:u.value});if(!e.ok){n("error",`LLM connection failed: ${e.error}`);return}n("ok",`LLM connection OK: ${e.assistantText}`)}catch{n("error","LLM connection failed")}finally{g.value=!1}}async function K(){c.value=a.topN,p.value=a.closeOnSave,l.value=a.ai.enabled,i.value=a.ai.alwaysSuggest,r.value=a.ai.baseUrl,u.value=a.ai.model,b.value=a.ai.apiKey,await x()}return N(async()=>{try{const t=await E();c.value=t.topN,p.value=t.closeOnSave,l.value=t.ai.enabled,i.value=t.ai.alwaysSuggest,r.value=t.ai.baseUrl,u.value=t.ai.model,b.value=t.ai.apiKey}catch{n("error","Failed to load settings")}}),(t,e)=>(A(),L("main",F,[e[18]||(e[18]=s("header",{class:"header"},[s("h1",{class:"title"},"Smart Bookmark — Options"),s("p",{class:"subtitle"},"Settings are stored locally in your browser profile.")],-1)),s("section",H,[e[10]||(e[10]=s("h2",{class:"card-title"},"General",-1)),s("div",G,[e[7]||(e[7]=s("label",{class:"label",for:"topN"},"Recommended folders (Top N)",-1)),v(s("input",{id:"topN",class:"input",type:"number",min:"1",max:"10",step:"1","onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o)},null,512),[[w,c.value,void 0,{number:!0}]])]),s("div",j,[e[8]||(e[8]=s("label",{class:"label",for:"closeOnSave"},"Close popup after saving",-1)),v(s("input",{id:"closeOnSave",type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o)},null,512),[[h,p.value]])]),s("div",{class:"row"},[s("button",{class:"link",type:"button",onClick:I},"Open Chrome shortcuts"),e[9]||(e[9]=s("span",{class:"hint"},"Configure the extension hotkey in Chrome.",-1))])]),s("section",z,[e[16]||(e[16]=s("h2",{class:"card-title"},"AI Fallback (OpenAI-compatible)",-1)),s("div",J,[e[11]||(e[11]=s("label",{class:"label",for:"aiEnabled"},"Enable AI fallback",-1)),v(s("input",{id:"aiEnabled",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=o=>l.value=o)},null,512),[[h,l.value]])]),s("div",Q,[e[12]||(e[12]=s("label",{class:"label",for:"alwaysSuggest"},"Always show AI suggestions",-1)),v(s("input",{id:"alwaysSuggest",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>i.value=o),disabled:!l.value},null,8,W),[[h,i.value]])]),s("div",X,[e[13]||(e[13]=s("label",{class:"label",for:"baseUrl"},"Base URL",-1)),v(s("input",{id:"baseUrl",class:"input",type:"text",placeholder:"https://api.openai.com/v1","onUpdate:modelValue":e[4]||(e[4]=o=>r.value=o)},null,512),[[w,r.value,void 0,{trim:!0}]])]),s("div",Y,[e[14]||(e[14]=s("label",{class:"label",for:"model"},"Model",-1)),v(s("input",{id:"model",class:"input",type:"text",placeholder:"gpt-5.2","onUpdate:modelValue":e[5]||(e[5]=o=>u.value=o)},null,512),[[w,u.value,void 0,{trim:!0}]])]),s("div",Z,[e[15]||(e[15]=s("label",{class:"label",for:"apiKey"},"API Key",-1)),v(s("input",{id:"apiKey",class:"input",type:"password",placeholder:"sk-...","onUpdate:modelValue":e[6]||(e[6]=o=>b.value=o),autocomplete:"off"},null,512),[[w,b.value]])]),e[17]||(e[17]=s("p",{class:"hint"}," Requests are sent only when AI is enabled. If “Always show AI suggestions” is on, the popup will also fetch AI suggestions even when host-based matches exist; otherwise it only runs as a fallback. The request includes the current tab URL/title and folder candidates (id/path) — it does not upload existing bookmark URLs. ",-1))]),s("footer",ee,[m.kind!=="idle"?(A(),L("div",{key:0,class:M(["status",m.kind])},S(m.message),3)):P("",!0),s("div",se,[s("button",{class:"button secondary",type:"button",onClick:C,disabled:k.value},S(g.value?"Testing…":"Test LLM connection"),9,te),s("button",{class:"button secondary",type:"button",onClick:K,disabled:k.value},"Reset",8,ae),s("button",{class:"button",type:"button",onClick:x,disabled:k.value},S(y.value?"Saving…":"Save"),9,oe)])])]))}}),ne=B(le,[["__scopeId","data-v-b6111036"]]);$(ne).mount("#app");
